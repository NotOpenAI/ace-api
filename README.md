# Prerequisites

Make sure **Python3** is available on your machine. This project is using version 3.11. If you have multiple versions of Python, you can use a Python version manager such as [pyenv](https://github.com/pyenv/pyenv).

# Development

The following steps outline additional setups to work on this project.

## Install Dependencies
Make sure you have [pipx](https://pypa.github.io/pipx/) installed (requires pip 19.0+).

You can verify it by running:
```
pipx --version
```

Then install [poethepoet](https://poethepoet.natn.io/index.html) and [poetry](https://python-poetry.org/docs/master/) by running:
```
pipx install poethepoet && pipx install poetry
```
Finally, go to your root directory and run:

```
poe i
```
to install the dependencies and pre-commit hooks. You only have to run this once unless new packages have been added.

## Start Development Server

Navigate to the root directory and run:
```
poe start
```
to see live changes. This will start the application at `localhost:8000`

# Connect to Database
Create a **.env** file in the root directory and enter the credentials in the same format as **.env.example**

## Database Migrations

We are using [alembic](https://alembic.sqlalchemy.org/en/latest) for database migrations. 

If you want alembic to autogenerate your database revision file, run the command:
```
poetry run alembic revision --autogenerate -m "example revision message"
```
Keep in mind that alembic may not detect everything, such as schema creation, so always make sure to review the autogenerated file and verify the changes.

Then to "push" your changes to the database, run the command:
```
poetry run alembic upgrade head
```

## Initialize Database Locally Using Docker

Follow these steps to get the db tables setup on a local docker container:

    1. Install the docker engine: 
        https://docs.docker.com/engine/install/
    2. Add docker to path.  It will look something like: 
        C:\Program Files\Docker\Docker\resources\bin
    3. Create a dockerhub account: 
        https://hub.docker.com/
    4. Execute the following command using your dockerhub credentials
        docker login
    5. Execute the following command to create the local database container:
        docker run --name ace-db -p 5432:5432 -e POSTGRES_PASSWORD=pass -d postgres
    6. Edit line 20 of alembic/env.py to make exactly:
        DB_URL = f"postgresql://postgres:pass@localhost:5432/postgres"
    7. Run the following commands to populate the containerized database with the tables:
        alembic upgrade head
        poetry run alembic revision --autogenerate -m "example revision message"
        poetry run alembic upgrade head
